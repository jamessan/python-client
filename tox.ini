[tox]
envlist =
  py{27,34,35,36,37,38,39}-{asyncio,pyuv}-cov,pypy{,2,3}-cov
  checkqa

[gh-actions]
python =
  2.7: py27
  3.5: py35
  3.6: py36
  3.7: py37
  3.8: py38
  3.9: py39
  pypy2: pypy2
  pypy3: pypy3

[testenv]
extras = test
deps =
  pytest-timeout
  cov: pytest-cov
  pyuv: pyuv
setenv =
  cov: PYTEST_ADDOPTS=--cov=. {env:PYTEST_ADDOPTS:}
passenv = PYTEST_ADDOPTS
commands =
  python -m pytest {posargs}

[testenv:checkqa]
deps =
  flake8
  flake8-import-order
  flake8-docstrings
  pep8-naming
commands = flake8 {posargs:pynvim test}

[testenv:docs]
deps =
  Sphinx
  sphinx_rtd_theme
changedir = {toxinidir}/docs
commands =
  sphinx-build -b html -d {envtmpdir}/doctrees . {envtmpdir}/html
